<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui" template="/template/template.xhtml">

	<ui:define name="cuerpo">
		<h:form prependId="false" id="gestion">
			<p:tabView id="tablaContent">
			<p:tab title="ETL Proceso 2: Transformation" dynamic="true" cache="true">

				<h:panelGrid columns="1">
					<p:commandButton rendered="#{transformationETL.auditoriasDW == null}" action="/paginas/seguro/etl/Extraction.xhtml?faces-redirect=true" id="aviso"  ajax="false" value="Vamos colega! realiza el proceso 1 de ETL: Extraccion" class="register aviso animated flash"/>
				</h:panelGrid>
				
				<div class="tipocarga">
				<h:outputText value="Tipo de carga de datos: Acumulacion Simple" rendered="#{extractionETL.tipoCargaDatos == 1}"/>
				<h:outputText value="Tipo de carga de datos: Rollin" rendered="#{extractionETL.tipoCargaDatos == 2}"/>
				</div>
							
				<p:accordionPanel id="panelTablaEmp">
				
					<p:tab title="Auditoria" rendered="#{transformationETL.auditoriasDW.size() > 0}">
						<p:dataTable value="#{transformationETL.auditoriasDW}" id="tabla"
							var="a" border="1">
														
							<p:column>
								<f:facet name="header">
								Accion
							</f:facet>
								<p:outputLabel value="#{a.accion}" />
							</p:column>
							
							<p:column>
								<f:facet name="header">
								Tabla
							</f:facet>
								<p:outputLabel value="#{a.tabla}" />
							</p:column>
							
							<p:column>
								<f:facet name="header">
								Registro
							</f:facet>
								<p:outputLabel value="#{a.registro}" />
							</p:column>
							
							<p:column>
								<f:facet name="header">
								Origen
							</f:facet>
								<p:outputLabel value="#{a.origen}" />
							</p:column>
							
							<p:column>
								<f:facet name="header">
								Navegador
							</f:facet>
								<p:outputLabel value="#{a.navegador}" />
							</p:column>

							<p:column>
								<f:facet name="header">
								Fecha
							</f:facet>
								<p:outputLabel value="#{a.fecha}" />
							</p:column>
													
						</p:dataTable>
					</p:tab>
					
					
					<p:tab title="Ventas" rendered="#{transformationETL.ventasDW.size() > 0}">
						<p:dataTable value="#{transformationETL.ventasDW}" id="tabla2"
							var="v" border="1">
	
							<p:column>
								<f:facet name="header">
								fecha_venta
							</f:facet>
								<p:outputLabel value="#{v.fachaVenta}" />
							</p:column>
							
							<p:column>
								<f:facet name="header">
								valorTotal
							</f:facet>
								<p:outputLabel value="#{v.valorTotal}" />
							</p:column>
							
							<p:column>
								<f:facet name="header">
								empresa
							</f:facet>
								<p:outputLabel value="#{v.empresa.codigo}" />
							</p:column>
							
							<p:column>
								<f:facet name="header">
								personaEmpleado
							</f:facet>
								<p:outputLabel value="#{v.personaEmpleado.codigo}" />
							</p:column>
							
							<p:column>
								<f:facet name="header">
								personaCliente
							</f:facet>
								<p:outputLabel value="#{v.personaCliente.codigo}" />
							</p:column>
													
						</p:dataTable>
					</p:tab>
					
					<p:tab title="Clientes" rendered="#{transformationETL.ventasDW.size() > 0}">
						<p:dataTable value="#{transformationETL.ventasDW}" id="tabla3"
							var="v" border="1">
							
							<p:column>
								<f:facet name="header">
								cedula
							    </f:facet>
								<p:outputLabel value="#{v.personaCliente.cedula}" />
							</p:column>
							
							<p:column>
								<f:facet name="header">
								genero
							    </f:facet>
								<p:outputLabel value="#{v.personaCliente.genero.nombre}" />
							</p:column>
							
							<p:column>
								<f:facet name="header">
								fecha nacimiento
							    </f:facet>
								<p:outputLabel value="#{v.personaCliente.fechaNacimiento}" />
							</p:column>
							
							<p:column>
								<f:facet name="header">
								fecha ingreso
							    </f:facet>
								<p:outputLabel value="#{v.personaCliente.fechaIngreso}" />
							</p:column>
							
							<p:column>
								<f:facet name="header">
								salario
							    </f:facet>
								<p:outputLabel value="#{v.personaCliente.salario}" />
							</p:column>
							
							<p:column>
								<f:facet name="header">
								rol
							    </f:facet>
								<p:outputLabel value="#{v.personaCliente.rol}" />
							</p:column>
							
							<p:column>
								<f:facet name="header">
								municipio
							    </f:facet>
								<p:outputLabel value="#{v.personaCliente.municipio}" />
							</p:column>
							
							<p:column>
								<f:facet name="header">
								area empresa
							    </f:facet>
								<p:outputLabel value="#{v.personaCliente.areaEmpresa}" />
							</p:column>
													
						</p:dataTable>
					</p:tab>
					
					<p:tab title="Ã‰mpleados" rendered="#{transformationETL.ventasDW.size() > 0}">
						<p:dataTable value="#{transformationETL.ventasDW}" id="tabla4"
							var="v" border="1">
							
							<p:column>
								<f:facet name="header">
								cedula
							    </f:facet>
								<p:outputLabel value="#{v.personaEmpleado.cedula}" />
							</p:column>
							
							<p:column>
								<f:facet name="header">
								genero
							    </f:facet>
								<p:outputLabel value="#{v.personaEmpleado.genero}" />
							</p:column>
							
							<p:column>
								<f:facet name="header">
								fecha nacimiento
							    </f:facet>
								<p:outputLabel value="#{v.personaEmpleado.fechaNacimiento}" />
							</p:column>
							
							<p:column>
								<f:facet name="header">
								fecha ingreso
							    </f:facet>
								<p:outputLabel value="#{v.personaEmpleado.fechaIngreso}" />
							</p:column>
							
							<p:column>
								<f:facet name="header">
								salario
							    </f:facet>
								<p:outputLabel value="#{v.personaEmpleado.salario}" />
							</p:column>
							
							<p:column>
								<f:facet name="header">
								rol
							    </f:facet>
								<p:outputLabel value="#{v.personaEmpleado.rol}" />
							</p:column>
							
							<p:column>
								<f:facet name="header">
								municipio
							    </f:facet>
								<p:outputLabel value="#{v.personaEmpleado.municipio}" />
							</p:column>
							
							<p:column>
								<f:facet name="header">
								area empresa
							    </f:facet>
								<p:outputLabel value="#{v.personaEmpleado.areaEmpresa}" />
							</p:column>
													
						</p:dataTable>
					</p:tab>
					
				</p:accordionPanel>
				
				<h:panelGrid columns="2">
				    <p:commandButton id="btatras"  ajax="false" value="Regresar"  action="/paginas/seguro/etl/Extraction.xhtml?faces-redirect=true" class="login"/>
					<p:commandButton rendered="#{transformationETL.auditoriasDW != null}" action="#{transformationETL.cargar()}" id="btregis"  ajax="false" value="Paso 3 ETL: Cargar datos al Data Warehouse" class="register"/>
				</h:panelGrid>
				</p:tab>
			</p:tabView>
		</h:form>
	</ui:define>

</ui:composition>